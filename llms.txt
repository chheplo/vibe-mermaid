# Vibe Mermaid

> AI-powered diagram creation through natural conversation

A browser-based diagram editor that combines AI chat with visual rendering. Users describe diagrams in plain language, and the AI generates Mermaid code or mindmap syntax that renders instantly. The application runs entirely in the browser with no backend required.

## Product Overview

Vibe Mermaid is an interactive diagram creation tool that combines Mermaid.js with AI-assisted diagram generation and a custom D3.js-based mindmap renderer. Users can create flowcharts, mindmaps, and other diagrams through natural language conversation with an AI assistant, voice input, or by directly editing diagram code.

### Key Value Propositions

- **Conversational Interface**: Describe diagrams in everyday language instead of learning syntax
- **No Installation**: Pure web application, runs entirely in browser
- **Privacy-First**: Client-side only, API keys never leave your browser
- **Multi-Format Export**: SVG, PNG, and source code export
- **Voice Enabled**: Hands-free diagram creation via speech input

## Core Features

### 1. AI-Powered Diagram Generation
- Natural language input via text or voice
- Iterative refinement through conversation  
- Context-aware modifications to existing diagrams
- Support for OpenAI, Azure OpenAI, local LLMs, and any OpenAI-compatible API
- JSON-mode responses for reliable parsing

### 2. Dual Rendering System

**Standard Mermaid Renderer:**
- Flowcharts, sequence diagrams, class diagrams, state diagrams
- Entity relationship diagrams, Gantt charts, pie charts, git graphs
- All standard Mermaid.js diagram types
- Uses Mermaid.js v10 with configurable themes

**Custom Mindmap Renderer:**
- Built with D3.js for enhanced visualization
- Balanced tree layout with aligned node positioning
- Interactive zoom, pan, and hover effects
- Color-coded depth levels
- Automatic text wrapping and collision detection
- Custom syntax extensions (tools annotations)

### 3. Voice Input System
- Browser-based Web Speech API integration
- Real-time speech-to-text transcription
- Visual listening indicator with animated waves
- Edit transcription before sending
- Works in Chrome, Edge, and Safari
- Graceful degradation when unavailable

### 4. Advanced Theme System

**Dual Theme Architecture:**
- **UI Theme**: Light/dark mode for application interface (independent control)
- **Diagram Theme**: 14 professional themes for rendered output

**Available Diagram Themes:**
- Built-in: dark, default, forest, neutral
- Custom: slate, ocean, emerald, sunset, rose, cyberpunk, grayscale, high contrast, pastel, halloween
- Independent UI and diagram themes allow dark editor with light diagrams (or vice versa)
- Smooth theme transitions without page reload
- Persistent preferences across sessions

### 5. Export Capabilities
- **SVG Export**: Vector format preserving quality at any scale
- **PNG Export**: High-resolution raster (2x scale) with transparency
- **MMD Export**: Raw Mermaid/mindmap source code
- Customizable export filenames
- One-click download

### 6. Collapsible Chat Sidebar
- Toggle button to maximize diagram workspace
- Collapses from 360px to 48px for more screen space
- Smooth animations with 0.3s transitions
- Centered toggle button in collapsed state
- Purple hover effects with scale animation
- State persists across sessions via localStorage
- Responsive: maintains single-column layout on mobile (≤920px)
- Accessible with dynamic "Collapse"/"Expand" tooltips

### 7. Interactive Workspace

**Zoom & Pan Controls:**
- Zoom in/out buttons with intuitive controls
- Mouse wheel zoom support
- Pan by dragging canvas
- Reset to default view
- Preserved across diagram updates

**Dual View Modes:**
- Preview tab: Live rendered diagram
- Code tab: Direct syntax editing with monospace font
- Run button to apply manual code changes
- Seamless switching between views

**Session Management:**
- New session templates: empty, flowchart, mindmap
- Clear chat and diagram without losing settings
- Confirmation prompts prevent accidental data loss

### 8. Mobile & Responsive Design
- Fully responsive layout with breakpoints at 920px, 768px, 480px
- Collapsible burger menu on mobile
- Touch-optimized controls
- Adaptive chat/workspace sizing
- Single-column layout on small screens

## Technical Architecture

### Technology Stack

**Frontend:**
- Pure vanilla JavaScript (no build step, no frameworks)
- HTML5 with semantic structure
- CSS3 with custom properties and glassmorphism effects

**External Libraries:**
- Mermaid.js v10 (ES modules via CDN)
- D3.js v7 (tree layout algorithms)
- Google Fonts: Inter and JetBrains Mono

**Browser APIs:**
- LocalStorage API for persistence
- Web Speech API for voice input
- Canvas API for PNG export
- Fetch API for OpenAI-compatible chat

### File Structure

```
/
├── index.html              # Main UI shell
├── styles.css              # Complete styling system
├── src/
│   ├── app.js              # Core application controller
│   ├── mermaid.js          # Dual renderer system
│   ├── mindmap-renderer.js # Custom D3 mindmap renderer
│   ├── provider.js         # OpenAI-compatible API client
│   └── speech.js           # Voice input integration
├── replit.md               # Architecture documentation
└── llms.txt                # This file
```

### State Management

**Centralized State (app.js):**
- User settings (API credentials, model selection)
- Current diagram code and type detection
- Chat conversation history
- Theme preferences (UI and Mermaid themes)
- Diagram naming for exports
- Chat sidebar collapse state

**LocalStorage Keys:**
- `mermaid_copilot_settings`: JSON object with API config
- `mermaid_copilot_ui_theme`: 'light' or 'dark'
- `mermaid_copilot_theme`: Diagram theme name
- `mermaid_copilot_chat_collapsed`: 'true' or 'false'
- `mermaid_copilot_name`: Export filename base

### Rendering Pipeline

**Flow:**
1. User input (chat/voice/code) → diagram update trigger
2. `renderDiagram()` detects type from first line
3. Routes to Mermaid renderer or custom mindmap renderer
4. DOM updated with new SVG
5. Zoom/pan state preserved
6. Error handling with fallback messaging

**Type Detection:**
- `mindmap` keyword → custom D3 renderer
- All other types → Mermaid.js renderer
- Graceful syntax error handling

### AI Integration Pattern

**Conversation Flow:**
1. System prompt establishes Vibe Mermaid persona and rules
2. Current diagram state included as context
3. User message appended to conversation history
4. API response parsed as JSON with `explanation` and `code` fields
5. New diagram rendered, explanation shown in chat
6. Full conversation retained for context awareness

**Prompt Engineering:**
- JSON mode enforced via `response_format: { type: 'json_object' }`
- Instructions for incremental updates vs. full rewrites
- Examples for both Mermaid and custom mindmap syntax
- Error recovery and clarification strategies

## Custom Mindmap Syntax

Enhanced syntax with tools annotations:

```
mindmap
  root((Central Idea))
    (Branch 1)
      Topic A - tools: specific tools used
      Topic B
    (Branch 2)
      Topic C
      Topic D - tools: more tools
```

**Features:**
- Balanced tree layout algorithm
- Color-coded depth levels
- Aligned box nodes with automatic sizing
- Interactive hover tooltips
- Zoom/pan with smooth transitions

## Getting Started

### Initial Setup

1. Open Vibe Mermaid in a modern browser
2. Click **Settings** button (top right)
3. Configure API provider:
   - **API Base URL**: Default is OpenAI, or use custom endpoint
   - **API Key**: Your provider's API key (stored locally only)
   - **Model**: Select model (e.g., gpt-4o-mini, gpt-4, claude-3-5-sonnet)
4. Click **Save** to persist settings

### Creating Your First Diagram

**Via Chat:**
- Type: "Create a flowchart showing user login with password reset"
- Or click microphone: Speak your diagram description
- AI generates diagram code and explanation
- View live preview instantly

**Via Code Editor:**
- Switch to **Code** tab
- Write Mermaid syntax directly
- Click ▶ button to render
- Switch back to **Preview** tab

### Modifying Diagrams

**Iterative Refinement:**
- "Add a decision node for email verification"
- "Change the theme to ocean"
- "Add error handling after authentication"
- "Make the 'Success' node green"

**Direct Editing:**
- Use Code tab for precise control
- Mix chat and manual editing
- All changes reflect immediately

### Exporting

1. Set filename in header input field
2. Click **Export** dropdown
3. Choose format:
   - **Save .mmd**: Source code for version control
   - **Export SVG**: Vector format for presentations
   - **Export PNG**: High-res raster for documents
4. File downloads automatically

## Usage Examples

### Example 1: Software Architecture
**Prompt**: "Create a sequence diagram showing how a REST API authenticates users with JWT tokens"

**Result**: Full sequence diagram with actors, API endpoints, and authentication flow

### Example 2: Project Planning
**Prompt**: "Make a mindmap for launching a mobile app with branches for development, marketing, and operations"

**Result**: Hierarchical mindmap with color-coded categories and sub-tasks

### Example 3: Process Documentation
**Prompt**: "Flowchart for customer support ticket lifecycle from creation to resolution"

**Result**: Complete flowchart with decision points, states, and transitions

## Configuration

### Supported AI Providers

**OpenAI:**
- Base URL: `https://api.openai.com/v1`
- Models: gpt-4o, gpt-4o-mini, gpt-4-turbo, etc.

**Azure OpenAI:**
- Custom endpoint URL
- Your deployment name as model

**Local LLMs:**
- Ollama: `http://localhost:11434/v1`
- LM Studio: `http://localhost:1234/v1`
- Any OpenAI-compatible server

**Other Services:**
- Anthropic (via proxy)
- Google Gemini (via proxy)
- Custom proxies with OpenAI format

## Advanced Features

### Keyboard Shortcuts
- **Cmd/Ctrl + Enter**: Send chat message from textarea
- **Tab**: Navigate between controls
- **Escape**: Close dropdown menus

### Mobile Optimization
- Burger menu for compact navigation
- Touch-friendly button sizing
- Adaptive text input behavior
- Optimized chat/workspace ratio

### Accessibility
- Semantic HTML structure
- ARIA labels on interactive controls
- Keyboard navigation support
- Focus management
- High contrast theme option
- Tooltip descriptions on all buttons

## Security & Privacy

### Data Handling
- **No backend servers**: Entirely client-side application
- **API keys**: Stored only in browser localStorage, never transmitted to Vibe Mermaid
- **Conversations**: Kept in browser memory, cleared on page refresh or session reset
- **No tracking**: No analytics, cookies, or external tracking scripts

### Best Practices
- Use HTTPS for API communication
- Keep API keys secure (don't share screenshots with keys visible)
- Consider using read-only API keys if provider supports them
- Regularly rotate API keys per provider guidelines

## Browser Compatibility

### Fully Supported
- Chrome 90+ ✅
- Edge 90+ ✅
- Firefox 88+ ✅
- Safari 14+ ✅

### Feature Support
- Voice input: Chrome, Edge, Safari (vendor prefixes)
- LocalStorage: All modern browsers
- Canvas export: All modern browsers
- ES modules: All modern browsers

### Known Limitations
- Voice input unavailable in Firefox
- Older browsers may lack ES module support
- Mobile Safari may have voice input restrictions

## Performance

- **Instant Loading**: No build step, minimal initial payload
- **Fast Rendering**: Efficient SVG generation and DOM updates
- **Smooth Animations**: Hardware-accelerated CSS transitions
- **Optimized Dependencies**: CDN-hosted, cached libraries
- **Minimal Memory**: LocalStorage footprint under 1MB typically

## Use Cases

### Software Development
- Architecture diagrams
- API documentation
- Database schemas
- State machine diagrams
- Git branching strategies

### Project Management
- Project roadmaps (Gantt charts)
- Workflow diagrams
- Process documentation
- Mind mapping brainstorms
- Organizational charts

### Education
- Concept mapping
- Study guides
- Presentation visuals
- Algorithm flowcharts
- Timeline diagrams

### Business
- Decision trees
- Customer journey maps
- Process flows
- Reporting structures
- Strategic planning

## Development Guidelines

### Adding New Features

**New Diagram Types:**
1. Check Mermaid.js native support first
2. Extend detection logic in `renderDiagram()`
3. Update AI prompt templates if needed
4. Test with various themes

**Theme Customization:**
1. Add theme definition in `getMermaidPreset()` in app.js
2. Include in theme dropdown in index.html
3. Test across diagram types for consistency
4. Document color choices

**UI Modifications:**
1. Follow glassmorphism patterns in styles.css
2. Maintain responsive breakpoints
3. Test mobile and desktop layouts
4. Ensure accessibility compliance

### Code Conventions

- **Vanilla JS**: No frameworks, keep it simple
- **ES6+**: Use modern JavaScript features
- **LocalStorage**: Prefix all keys with `mermaid_copilot_`
- **Functions**: Clear naming, single responsibility
- **Comments**: Document complex logic only

## Troubleshooting

### Common Issues

**Diagrams not rendering:**
- Check browser console for syntax errors
- Verify Mermaid syntax is valid
- Try simpler diagram to isolate issue

**API errors:**
- Verify API key is correct in Settings
- Check API base URL matches provider
- Ensure model name is valid for provider
- Check browser console for error details

**Voice input not working:**
- Confirm browser supports Web Speech API
- Check microphone permissions
- Try Chrome/Edge for best compatibility

**Export issues:**
- Render diagram before exporting
- Check filename doesn't contain special characters
- Try different export format

## Limitations

- Requires internet for AI features (local LLMs can work offline)
- API costs are user's responsibility
- No real-time collaboration (single-user)
- No cloud storage (browser-based only)
- Diagram complexity limited by Mermaid.js/D3.js

## Future Enhancements

Potential improvements (not yet implemented):
- Collaborative editing with WebRTC
- Cloud storage integration (optional)
- More custom renderers (UML, etc.)
- Template library marketplace
- Version history with diffs
- Import from other formats
- Bulk export operations

## Credits & Attribution

**Built With:**
- Mermaid.js by Knut Sveidqvist (MIT License)
- D3.js by Mike Bostock (ISC License)
- Google Fonts: Inter and JetBrains Mono
- Inspired by diagram-as-code philosophy

**Design Philosophy:**
- Simplicity over complexity
- Privacy by default
- Progressive enhancement
- Accessibility first
- No vendor lock-in

---

**Version**: 2024
**License**: Open source, check repository for details
**Platform**: Web-based, no installation required
